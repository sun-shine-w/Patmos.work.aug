<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8ì›” ì¶œê·¼ì ëª…ë‹¨ (8/4~8/29)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ì¶œê·¼ì í‘œ ì „ìš© ìŠ¤íƒ€ì¼ */
        .attendance-table {
            width: 100%;
            border-collapse: collapse;
        }

        .date-row {
            border-bottom: 1px solid #e5e7eb;
        }

        .date-row:hover {
            background-color: #f9fafb;
        }

        .date-cell {
            padding: 12px 8px;
            vertical-align: top;
            width: 120px;
            font-weight: bold;
            background-color: #f9fafb;
            border-right: 1px solid #e5e7eb;
        }

        .attendance-cell {
            padding: 12px;
            vertical-align: top;
        }

        .location-section {
            margin-bottom: 8px;
        }

        .location-header {
            font-weight: bold;
            color: #374151;
            margin-bottom: 4px;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .location-p {
            background-color: #ddd6fe;
            color: #5b21b6;
        }

        .location-b {
            background-color: #bfdbfe;
            color: #1e40af;
        }

        .employee-list {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 4px;
        }

        .employee-tag {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            white-space: nowrap;
            font-weight: 500;
        }

        .employee-normal {
            background-color: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .employee-special {
            background-color: #fef3c7;
            color: #92400e;
            border: 1px solid #f59e0b;
        }

        .vacation-info {
            font-size: 11px;
            color: #dc2626;
            margin-top: 6px;
            font-style: italic;
            background-color: #fef2f2;
            padding: 4px 8px;
            border-radius: 4px;
            border-left: 3px solid #dc2626;
        }

        .stats-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            font-size: 13px;
            font-weight: 600;
        }

        .weekend-note {
            background-color: #f3f4f6;
            color: #6b7280;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 4px;
            font-style: italic;
        }

        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 768px) {
            .main-container {
                padding: 8px;
            }
            
            .date-cell {
                width: 70px;
                padding: 8px 4px;
                font-size: 11px;
            }
            
            .attendance-cell {
                padding: 8px;
            }
            
            .employee-tag {
                font-size: 10px;
                padding: 2px 6px;
            }
            
            .location-header {
                font-size: 10px;
                padding: 2px 6px;
            }
            
            .stats-info {
                font-size: 11px;
                flex-direction: column;
                align-items: flex-start;
                gap: 2px;
            }
            
            .main-title {
                font-size: 18px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="main-container max-w-6xl mx-auto p-4 sm:p-6">
        <!-- í—¤ë” -->
        <div class="mb-6 text-center">
            <h1 class="main-title text-2xl sm:text-3xl font-bold text-gray-800 mb-2">
                ğŸ“‹ 8ì›” ì¶œê·¼ì ëª…ë‹¨
            </h1>
            <p class="text-sm sm:text-base text-gray-600">2025ë…„ 8ì›” 4ì¼ ~ 8ì›” 29ì¼ (í‰ì¼ë§Œ)</p>
            <div class="mt-4 flex items-center justify-center">
                <div class="w-4 h-4 bg-green-500 rounded-full mr-2"></div>
                <span class="text-green-700 font-semibold text-sm">íŒ»ë¨¸ìŠ¤ ì‹¤ì œ ë°ì´í„°</span>
            </div>
        </div>

        <!-- ë²”ë¡€ -->
        <div class="mb-6 bg-white rounded-lg shadow-sm p-4">
            <h4 class="text-sm font-semibold text-gray-700 mb-3 text-center">ë²”ë¡€</h4>
            <div class="flex flex-wrap items-center justify-center gap-4 text-xs">
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-purple-100 border border-purple-300 rounded mr-2"></div>
                    <span>[íŒ»ë¨¸ìŠ¤] ê·¼ë¬´ì§€</span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-blue-100 border border-blue-300 rounded mr-2"></div>
                    <span>[ë°±ì„] ê·¼ë¬´ì§€</span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-yellow-200 border border-yellow-400 rounded mr-2"></div>
                    <span>íŠ¹ë³„ ê·¼ë¬´ (ìŠ¹ë²”: ê¸ˆìš”ì¼ [íŒ»ë¨¸ìŠ¤], ì°½ë³¸: í™”ìˆ˜ëª©ê¸ˆ [ë°±ì„])</span>
                </div>
                <div class="flex items-center">
                    <div class="w-4 h-4 bg-gray-100 border border-gray-300 rounded mr-2"></div>
                    <span>ì •ê·œ ê·¼ë¬´</span>
                </div>
            </div>
        </div>

        <!-- ì¶œê·¼ì í‘œ -->
        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <div class="overflow-x-auto">
                <table id="attendance-table" class="attendance-table w-full">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="date-cell text-left">ë‚ ì§œ</th>
                            <th class="text-left p-4">ì¶œê·¼ì í˜„í™©</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ìš”ì•½ í†µê³„ -->
        <div class="mt-6 bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-bold text-gray-800 mb-4 text-center">8ì›” ìš”ì•½ í†µê³„</h3>
            <div id="summary-stats" class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-center">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        // 8ì›” íœ´ê°€ ë°ì´í„° (8/4~8/29 ê´€ë ¨ë§Œ)
        const vacationData = {
            "2025-08-07": [{"name": "ë°•ì§€ì›", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-08": [{"name": "ë°•ì§€ì›", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì•ˆí˜¸ì˜", "type": "ì—°ì°¨", "duration": 3}, {"name": "ì •ì§€ìˆ˜", "type": "ì—°ì°¨", "duration": 1}],
            "2025-08-11": [{"name": "ê¹€ëª…ì§„", "type": "ì—°ì°¨", "duration": 3}, {"name": "ì•ˆí˜¸ì˜", "type": "ì—°ì°¨", "duration": 3}, {"name": "ê¹€ë‹¤ì• ", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-12": [{"name": "ê¹€ëª…ì§„", "type": "ì—°ì°¨", "duration": 3}, {"name": "ì•ˆí˜¸ì˜", "type": "ì—°ì°¨", "duration": 3}, {"name": "ê¹€ë‹¤ì• ", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-13": [{"name": "ê¹€ëª…ì§„", "type": "ì—°ì°¨", "duration": 3}, {"name": "ê¹€ìƒˆë¡", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-14": [{"name": "ë°•ì§€ì›", "type": "ì—°ì°¨", "duration": 1}, {"name": "ê¹€ìˆ˜ê²½", "type": "ì—°ì°¨", "duration": 1}, {"name": "ê¹€ìƒˆë¡", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì´í˜•ë…¸", "type": "ì—°ì°¨", "duration": 1}, {"name": "ì¡°ìŠ¬ê¸°", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-18": [{"name": "ê¹€ìˆ˜ê²½", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì¡°ìŠ¬ê¸°", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-19": [{"name": "ê¹€ìˆ˜ê²½", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-20": [{"name": "ì •ì§€ìˆ˜", "type": "ì—°ì°¨", "duration": 3}, {"name": "ì‹ ì„ ì˜", "type": "ì—°ì°¨", "duration": 3}],
            "2025-08-21": [{"name": "ì •ì§€ìˆ˜", "type": "ì—°ì°¨", "duration": 3}, {"name": "ì‹ ì„ ì˜", "type": "ì—°ì°¨", "duration": 3}, {"name": "ê¹€ëª…ì§„", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì´í˜•ë…¸", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-22": [{"name": "ì •ì§€ìˆ˜", "type": "ì—°ì°¨", "duration": 3}, {"name": "ì‹ ì„ ì˜", "type": "ì—°ì°¨", "duration": 3}, {"name": "ê¹€ëª…ì§„", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì´í˜•ë…¸", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-25": [{"name": "ê¹€ë‹¤ì• ", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì•ˆí˜¸ì˜", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì´ì˜ˆì€", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-26": [{"name": "ê¹€ë‹¤ì• ", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì•ˆí˜¸ì˜", "type": "ì—°ì°¨", "duration": 2}, {"name": "ì´ì˜ˆì€", "type": "ì—°ì°¨", "duration": 2}],
            "2025-08-29": [{"name": "ì´ì˜ˆì€", "type": "ì—°ì°¨", "duration": 1}, {"name": "ì¡°ìŠ¬ê¸°", "type": "ì—°ì°¨", "duration": 1}]
        };

        // ì§ì› ëª…ë‹¨
        const employees = {
            P: ['í˜œë¯¸', 'ìŠ¬ê¸°', 'ëª…ì§„', 'ì§€ìˆ˜', 'ë‹¤ì• ', 'ì˜ˆì€', 'ì„±ë¯¼'],
            B: ['ì§€ì›', 'ì„ ì˜', 'ìƒˆë¡', 'ìˆ˜ê²½', 'í˜¸ì˜', 'í˜•ë…¸']
        };

        // ì´ë¦„ ë§¤í•‘
        const nameMapping = {
            'í˜œë¯¸': 'í•œí˜œë¯¸', 'ìŠ¬ê¸°': 'ì¡°ìŠ¬ê¸°', 'ëª…ì§„': 'ê¹€ëª…ì§„', 'ì§€ìˆ˜': 'ì •ì§€ìˆ˜',
            'ë‹¤ì• ': 'ê¹€ë‹¤ì• ', 'ì˜ˆì€': 'ì´ì˜ˆì€', 'ì§€ì›': 'ë°•ì§€ì›', 'ì„ ì˜': 'ì‹ ì„ ì˜',
            'ìƒˆë¡': 'ê¹€ìƒˆë¡', 'ìˆ˜ê²½': 'ê¹€ìˆ˜ê²½', 'í˜¸ì˜': 'ì•ˆí˜¸ì˜', 'í˜•ë…¸': 'ì´í˜•ë…¸'
        };

        function formatDate(year, month, day) {
            return `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        }

        function isHoliday(year, month, day) {
            const dateStr = formatDate(year, month, day);
            return dateStr === '2025-08-15'; // ê´‘ë³µì ˆ
        }

        // íŠ¹ë³„ ê·¼ë¬´ì ì²´í¬
        function getSpecialEmployees(year, month, day) {
            const date = new Date(year, month, day);
            const dayOfWeek = date.getDay();
            
            const special = { P: [], B: [] };
            
            // ë§¤ì£¼ ê¸ˆìš”ì¼ Pì— ìŠ¹ë²” ì¶”ê°€
            if (dayOfWeek === 5) {
                special.P.push('ìŠ¹ë²”');
            }
            
            // 8ì›” ë§ˆì§€ë§‰ ì£¼ ì œì™¸í•˜ê³  í™”ìˆ˜ëª©ê¸ˆ Bì— ì°½ë³¸ ì¶”ê°€
            if (dayOfWeek >= 2 && dayOfWeek <= 5) { // í™”ìˆ˜ëª©ê¸ˆ
                const isLastWeekOfAugust = month === 7 && day >= 25; // 8ì›” ë§ˆì§€ë§‰ ì£¼
                if (!isLastWeekOfAugust) {
                    special.B.push('ì°½ë³¸');
                }
            }
            
            return special;
        }

        // í•´ë‹¹ ë‚ ì§œì˜ íœ´ê°€ì ê°€ì ¸ì˜¤ê¸°
        function getVacationersForDate(year, month, day) {
            const dateStr = formatDate(year, month, day);
            const vacations = vacationData[dateStr] || [];
            return vacations.map(v => v.name);
        }

        // ì¶œê·¼ì ëª…ë‹¨ ìƒì„±
        function getAttendanceForDate(year, month, day) {
            const vacationers = getVacationersForDate(year, month, day);
            const special = getSpecialEmployees(year, month, day);
            
            const attendance = { P: [], B: [] };
            
            // ê° ê·¼ë¬´ì§€ë³„ë¡œ ì¶œê·¼ì ê³„ì‚°
            ['P', 'B'].forEach(location => {
                // ì •ê·œ ì§ì› ì¤‘ íœ´ê°€ê°€ ì•„ë‹Œ ì‚¬ëŒë“¤
                employees[location].forEach(employee => {
                    const fullName = nameMapping[employee];
                    if (!vacationers.includes(fullName)) {
                        attendance[location].push({ name: employee, type: 'normal' });
                    }
                });
                
                // íŠ¹ë³„ ê·¼ë¬´ì ì¶”ê°€
                special[location].forEach(employee => {
                    attendance[location].push({ name: employee, type: 'special' });
                });
            });
            
            return attendance;
        }

        // ì¶œê·¼ì í‘œ ë Œë”ë§
        function renderAttendanceTable() {
            const year = 2025;
            const month = 7; // 8ì›” (0-based)
            
            let tableHTML = '';
            let totalWorkdays = 0;
            let totalVacationDays = 0;
            let attendanceByLocation = { P: 0, B: 0 };
            
            // 8ì›” 4ì¼ë¶€í„° 29ì¼ê¹Œì§€
            for (let day = 4; day <= 29; day++) {
                const date = new Date(year, month, day);
                const dayOfWeek = date.getDay();
                
                // ì£¼ë§ê³¼ ê³µíœ´ì¼ ì œì™¸
                if (dayOfWeek === 0 || dayOfWeek === 6) continue;
                if (isHoliday(year, month, day)) continue;
                
                totalWorkdays++;
                
                const attendance = getAttendanceForDate(year, month, day);
                const vacationers = getVacationersForDate(year, month, day);
                const totalAttendance = attendance.P.length + attendance.B.length;
                
                attendanceByLocation.P += attendance.P.length;
                attendanceByLocation.B += attendance.B.length;
                totalVacationDays += vacationers.length;
                
                const dayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
                
                tableHTML += `
                    <tr class="date-row">
                        <td class="date-cell">
                            <div class="font-bold">8/${day}</div>
                            <div class="text-sm text-gray-600">(${dayNames[dayOfWeek]})</div>
                        </td>
                        <td class="attendance-cell">
                            <div class="stats-info">
                                <span class="text-green-600">âœ… ì¶œê·¼: ${totalAttendance}ëª…</span>
                                <span class="text-red-600">ğŸ–ï¸ íœ´ê°€: ${vacationers.length}ëª…</span>
                            </div>
                            
                            <div class="location-section">
                                <div class="location-header location-p">[íŒ»ë¨¸ìŠ¤] ${attendance.P.length}ëª…</div>
                                <div class="employee-list">
                                    ${attendance.P.map(emp => 
                                        `<span class="employee-tag ${emp.type === 'special' ? 'employee-special' : 'employee-normal'}">${emp.name}</span>`
                                    ).join('')}
                                </div>
                            </div>
                            
                            <div class="location-section">
                                <div class="location-header location-b">[ë°±ì„] ${attendance.B.length}ëª…</div>
                                <div class="employee-list">
                                    ${attendance.B.map(emp => 
                                        `<span class="employee-tag ${emp.type === 'special' ? 'employee-special' : 'employee-normal'}">${emp.name}</span>`
                                    ).join('')}
                                </div>
                            </div>
                            
                            ${vacationers.length > 0 ? `
                                <div class="vacation-info">
                                    ğŸ–ï¸ íœ´ê°€ì: ${vacationers.join(', ')}
                                </div>
                            ` : ''}
                        </td>
                    </tr>
                `;
            }
            
            document.getElementById('table-body').innerHTML = tableHTML;
            
            // ìš”ì•½ í†µê³„ ì—…ë°ì´íŠ¸
            const avgAttendanceP = Math.round(attendanceByLocation.P / totalWorkdays);
            const avgAttendanceB = Math.round(attendanceByLocation.B / totalWorkdays);
            const avgVacation = Math.round(totalVacationDays / totalWorkdays);
            
            document.getElementById('summary-stats').innerHTML = `
                <div class="bg-green-50 p-4 rounded-lg">
                    <div class="text-2xl font-bold text-green-600">${totalWorkdays}ì¼</div>
                    <div class="text-green-700 text-sm">ì´ ê·¼ë¬´ì¼</div>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg">
                    <div class="text-2xl font-bold text-purple-600">${avgAttendanceP}ëª…</div>
                    <div class="text-purple-700 text-sm">í‰ê·  [íŒ»ë¨¸ìŠ¤] ì¶œê·¼</div>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <div class="text-2xl font-bold text-blue-600">${avgAttendanceB}ëª…</div>
                    <div class="text-blue-700 text-sm">í‰ê·  [ë°±ì„] ì¶œê·¼</div>
                </div>
                <div class="bg-red-50 p-4 rounded-lg">
                    <div class="text-2xl font-bold text-red-600">${avgVacation}ëª…</div>
                    <div class="text-red-700 text-sm">í‰ê·  íœ´ê°€ì</div>
                </div>
            `;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', function() {
            renderAttendanceTable();
        });
    </script>
</body>
</html>
